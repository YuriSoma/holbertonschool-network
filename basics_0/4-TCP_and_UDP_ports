#!/usr/bin/env bash
# 4-TCP_and_UDP_ports
# Print only listening sockets with PID/Program name (netstat-style)

set -o errexit
set -o nounset
set -o pipefail

if [[ $EUID -ne 0 ]]; then
  echo "This script must be run as root." >&2
  exit 1
fi

if ! command -v netstat >/dev/null 2>&1; then
  echo "netstat (net-tools) not found. Install it, for example on Debian/Ubuntu:" >&2
  echo "  sudo apt update && sudo apt install -y net-tools" >&2
  exit 1
fi

# netstat prints the "Active Internet connections (only servers)" header itself
# so just invoke it for internet and UNIX domain sockets.
netstat -lptu

echo
netstat -lxp
